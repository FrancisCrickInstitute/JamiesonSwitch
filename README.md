This repository contains analysis code for the project '_Overnight   circuit remodelling drives juvenile alloparental care_' by Bradley B. Jamieson, Maxwell X. Chen, Swang Liang, Lina S. H. El Rasheed, Grace M. K. Chattey and Johannes Kohl

**Discrimination**
This script loads a CSV of z-scored responses where each column is a stimulus, converts it to long format, and then evaluates stimulus selectivity in two ways: (1) for each stimulus it computes a one-vs-rest ROC AUC using z-score as the classifier score and estimates the mean ± SEM AUC via 1000 bootstrap resamples (skipping resamples with only one class), and (2) it uses those bootstrapped AUC distributions to build a pairwise “dominance” matrix giving P(AUC_A > AUC_B) and a summary of how often each stimulus strongly beats others. It then computes a tuning specificity index (standardised mean difference of that stimulus vs all others using pooled SD), bootstraps its distribution, tests whether it is reliably > 0 with a one-sided Wilcoxon test, applies Benjamini–Hochberg FDR correction across stimuli, assigns significance stars, also calculates a per-animal per-stimulus TSI from each row of the original wide table, and finally exports all summaries (AUC ranks, dominance stats, pairwise matrix, tuning stats, and per-animal TSI) to a single results CSV.
